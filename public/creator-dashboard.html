<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Creator Dashboard | Art Club</title>

<style>
body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f4f4f4; }
header, section { padding:20px; }
h1,h2,h3 { color:#333; }

.navbar { background:#333; color:#fff; display:flex; justify-content:space-between; padding:10px 20px; align-items:center; }
.navbar a { color:#fff; text-decoration:none; margin-left:20px; }

/* Tabs */
.tab-bar {
    display:flex;
    background:white;
    border-bottom:2px solid #ccc;
    margin-top:20px;
    border-radius:10px 10px 0 0;
    overflow:hidden;
}
.tab-button {
    flex:1;
    padding:12px;
    text-align:center;
    cursor:pointer;
    background:#eee;
    border-right:1px solid #ccc;
    font-weight:bold;
}
.tab-button.active {
    background:white;
    border-bottom:3px solid #00796b;
}

/* Sections */
.tab-content {
    display:none;
    background:white;
    padding:20px;
    border-radius:0 0 10px 10px;
    box-shadow:0 2px 8px rgba(0,0,0,0.1);
    max-width:900px;
    margin:auto;
}
.tab-content.active { display:block; }

table { width:100%; border-collapse:collapse; margin-top:20px; }
th, td { padding:10px; border:1px solid #ccc; text-align:left; }
th { background:#eee; }

input, select { padding:6px 10px; margin:4px 0; }
button.assign, button.update {
    background:#00796b; 
    color:white; 
    border:none; 
    border-radius:6px; 
    cursor:pointer;
    padding:6px 10px;
}
button.assign:hover, button.update:hover { background:#004d40; }

.search-box {
    width:100%;
    padding:10px;
    margin-bottom:10px;
    border-radius:6px;
    border:1px solid #aaa;
}
</style>
</head>

<body>

<header class="navbar">
<h1 class="logo">Art Club</h1>
<div>
<a href="index.html">Home</a>
<button id="logout-btn">Logout</button>
</div>
</header>

<!-- TAB BUTTONS -->
<div class="tab-bar">
    <div class="tab-button active" data-tab="manage">Manage Users</div>
    <div class="tab-button" data-tab="allusers">All Users</div>
</div>

<!-- TAB 1: MANAGE USERS -->
<section id="manage" class="tab-content active">
<h1>Creator Dashboard</h1>
<p>Manage users, assign ranks, and update passwords.</p>

<table id="users-table">
<thead>
<tr>
<th>Username</th>
<th>Rank</th>
<th>Assign Rank</th>
<th>Change Password</th>
</tr>
</thead>
<tbody></tbody>
</table>
</section>

<!-- TAB 2: ALL USERS (VIEW ONLY) -->
<section id="allusers" class="tab-content">
<h1>All Users</h1>
<input type="text" id="search" class="search-box" placeholder="Search username...">

<table id="all-users-table">
<thead>
<tr>
<th>Username</th>
<th>Password</th>
<th>Rank</th>
</tr>
</thead>
<tbody></tbody>
</table>
</section>

<script>
// ------------------ PROTECT PAGE ------------------
const currentUser = JSON.parse(localStorage.getItem("currentUser"));
if(!currentUser || currentUser.rank !== "creator"){
    alert("Access denied! Only creators can access this page.");
    window.location.href = "index.html";
}

document.getElementById("logout-btn").addEventListener("click", () => {
    localStorage.removeItem("currentUser");
    window.location.href = "login.html";
});

// Load users
let users = JSON.parse(localStorage.getItem("users") || "[]");

// ------------------ TAB SWITCHER ------------------
document.querySelectorAll(".tab-button").forEach(btn => {
    btn.addEventListener("click", () => {
        document.querySelectorAll(".tab-button").forEach(b => b.classList.remove("active"));
        btn.classList.add("active");

        document.querySelectorAll(".tab-content").forEach(tab => tab.classList.remove("active"));
        document.getElementById(btn.dataset.tab).classList.add("active");
    });
});

// ------------------ RENDER MANAGE USERS TABLE ------------------
const tbody = document.querySelector("#users-table tbody");

function renderManageUsers() {
    tbody.innerHTML = "";

    users.forEach((user, index) => {
        const tr = document.createElement("tr");

        tr.innerHTML = `
            <td>${user.username}</td>
            <td>${user.rank}</td>
            <td>
                <select id="rank-${index}">
                    <option value="Beginner">Beginner</option>
                    <option value="Intermediate">Intermediate</option>
                    <option value="Advanced">Advanced</option>
                    <option value="Master">Master</option>
                    <option value="creator">Creator</option>
                </select>
                <button class="assign" data-index="${index}">Assign</button>
            </td>
            <td>
                <input type="password" id="pass-${index}" placeholder="New password">
                <button class="update" data-index="${index}">Update</button>
            </td>
        `;
        tbody.appendChild(tr);
    });
}

renderManageUsers();

// ------------------ ASSIGN RANK & UPDATE PASSWORD ------------------
tbody.addEventListener("click", e => {
    let index = e.target.dataset.index;

    if (e.target.classList.contains("assign")) {
        users[index].rank = document.getElementById(`rank-${index}`).value;
        localStorage.setItem("users", JSON.stringify(users));
        renderManageUsers();
        renderAllUsers();
        alert("Rank updated!");
    }

    if (e.target.classList.contains("update")) {
        const newPass = document.getElementById(`pass-${index}`).value;
        if (!newPass.trim()) return alert("Password cannot be empty.");
        users[index].password = newPass;
        localStorage.setItem("users", JSON.stringify(users));
        renderManageUsers();
        renderAllUsers();
        alert("Password updated!");
    }
});

// ------------------ RENDER ALL USERS TAB ------------------
const allUsersBody = document.querySelector("#all-users-table tbody");

function renderAllUsers(filter = "") {
    allUsersBody.innerHTML = "";

    users
        .filter(u => u.username.toLowerCase().includes(filter.toLowerCase()))
        .forEach(u => {
            const tr = document.createElement("tr");
            tr.innerHTML = `
                <td>${u.username}</td>
                <td>${u.password}</td>
                <td>${u.rank}</td>
            `;
            allUsersBody.appendChild(tr);
        });
}

renderAllUsers();

// ------------------ SEARCH BAR ------------------
document.getElementById("search").addEventListener("input", e => {
    renderAllUsers(e.target.value);
});
</script>

</body>
</html>
